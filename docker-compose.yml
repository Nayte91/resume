version: "3.5"

services:
  server:
    build:
      context: .
      dockerfile: system/Dockerfile
      args:
        NODE_VERSION: 16
        CADDY_VERSION: 2
    volumes:
      - caddy_data:/data
      - caddy_config:/config
###> Prod
#    labels:
#      traefik.http.routers.resume.rule: Host(`resume.anagraph.org`)
#    networks:
#      - proxy
#      - default
###< Prod
###> Dev
    ports:
      - 80:80
###< Dev

volumes:
  caddy_data:
  caddy_config:

###> Prod
# networks:
#   default:
#     external:
#       name: proxy
###< Prod